generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["referentialIntegrity"]
}

datasource db {
    provider             = "postgresql"
    url                  = env("DATABASE_URL")
    referentialIntegrity = "prisma"
}

enum Localidad {
    MarDelPlata
    Chapadmalal
    Batan
}

model Comercio {
    id         Int       @id @default(autoincrement())
    nombre     String
    categorias Json // es un string porque es un array de string serializado como string. Para consultar hacer JSON.parse() 
    direccion  String
    localidad  Localidad
    latitud    Float
    longitud   Float
    horario    String // este despues vuela, es para que no se rompa todo al migrar.
    horarios   Horario[]
    telefono   String
    imagenURL  String?   @db.Text

    // Redes
    facebookURL  String?
    instagramURL String?
    URL          String?

    productos           Producto[]
    estrellas           Int        @default(0)
    ratingPrecios       Int        @default(0)
    productosDiabeticos Boolean    @default(false)
    productosVeganos    Boolean    @default(false)
    validado            Boolean    @default(false)
}

enum CategoriaProducto {
    Frescos
    Panificados
    Elaborados
    Envasados
    Bebidas
    Postres
    Snacks
}

model Producto {
    id          Int               @id @default(autoincrement())
    nombre      String
    descripcion String?
    categoria   CategoriaProducto
    precio      Int // en centavos
    rating      Int               @default(0)
    imagen      String?
    validado    Boolean           @default(false)

    comercioId Int
    comercio   Comercio @relation(fields: [comercioId], references: [id])
}

enum DiaSemana {
    Lunes
    Martes
    Miercoles
    Jueves
    Viernes
    Sabado
    Domingo
}

model Horario {
    id         Int       @id @default(autoincrement())
    apertura   Int // en minutos desde las 00:00
    cierre     Int // en minutos desde las 00:00
    dia        DiaSemana
    comercioId Int
    comercio   Comercio  @relation(fields: [comercioId], references: [id])
}
